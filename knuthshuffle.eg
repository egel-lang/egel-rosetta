import "prelude.eg"

using System
using List
using IO
using Math

def swap =
    [ I, J, XX ->
        let I0 = nth I XX in
        let J0 = nth J XX in
            insert I J0 (insert J I0 XX) ]

def shuffle =
    [ XX ->
        let INDICES = reverse (fromto 0 ((length XX) -1)) in
        let SWAPS = map [ I -> I (between 0 I) ] INDICES in
            foldr [I J, XX -> swap I J XX ] XX SWAPS ]

def main = shuffle (fromto 1 9)
